<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Arbitrary Simulation Conditions · Kinetica.jl</title><meta name="title" content="Arbitrary Simulation Conditions · Kinetica.jl"/><meta property="og:title" content="Arbitrary Simulation Conditions · Kinetica.jl"/><meta property="twitter:title" content="Arbitrary Simulation Conditions · Kinetica.jl"/><meta name="description" content="Documentation for Kinetica.jl."/><meta property="og:description" content="Documentation for Kinetica.jl."/><meta property="twitter:description" content="Documentation for Kinetica.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Kinetica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Kinetica.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li class="is-active"><a class="tocitem" href>Arbitrary Simulation Conditions</a><ul class="internal"><li><a class="tocitem" href="#[ConditionSet](@ref)"><span><code>ConditionSet</code></span></a></li><li><a class="tocitem" href="#Condition-Profile-Showcase"><span>Condition Profile Showcase</span></a></li></ul></li><li><a class="tocitem" href="../ode-solution/">ODE Solution</a></li><li><a class="tocitem" href="../kinetic-calculators/">Kinetic Calculators</a></li><li><a class="tocitem" href="../iterative-exploration/">Iterative CRN Exploration</a></li><li><a class="tocitem" href="../results-analysis/">Results Analysis</a></li><li><a class="tocitem" href="../filtering-crns/">Filtering CRNs</a></li><li><a class="tocitem" href="../saving-loading/">Saving &amp; Loading</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><span class="tocitem">Developing with Kinetica</span><ul><li><a class="tocitem" href="../../development/crn-representation/">CRN Representation</a></li><li><a class="tocitem" href="../../development/condition-profiles/">Condition Profiles</a></li><li><a class="tocitem" href="../../development/calculator-interface/">Calculator Interface</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Kinetica.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/exploration/">Exploration</a></li><li><a class="tocitem" href="../../api/kinetica/solving/">Solving</a></li><li><a class="tocitem" href="../../api/kinetica/conditions/">Conditions</a></li><li><a class="tocitem" href="../../api/kinetica/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/kinetica/openbabel/">Open Babel</a></li><li><a class="tocitem" href="../../api/kinetica/rdkit/">RDKit</a></li><li><a class="tocitem" href="../../api/kinetica/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/kineticakpm/">KineticaKPM.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Arbitrary Simulation Conditions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Arbitrary Simulation Conditions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/main/docs/src/tutorials/arbitrary-conditions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Arbitrary-Simulation-Conditions"><a class="docs-heading-anchor" href="#Arbitrary-Simulation-Conditions">Arbitrary Simulation Conditions</a><a id="Arbitrary-Simulation-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Arbitrary-Simulation-Conditions" title="Permalink"></a></h1><p>Alongside the modular kinetic calculator interface, the ability to pass arbitrary combinations of simulation conditions through to be used in CRN integration is one of the key elements of extensibility and customisation within Kinetica.</p><p>By only requiring that conditions use consistent symbolic names at their definition and within a kinetic calculator, any variable condition profile, defined either directly or by its gradient with respect to time, can be symbolically bound to any quantity of interest.</p><h2 id="[ConditionSet](@ref)"><a class="docs-heading-anchor" href="#[ConditionSet](@ref)"><a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a></a><a id="[ConditionSet](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[ConditionSet](@ref)" title="Permalink"></a></h2><p>At the core of this system is the <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a>, which acts as an aggregator for individula condition profiles and their symbols. At their definition, <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a>s take a dictionary of <code>Symbol =&gt; Profile()</code> mappings. Each Symbol can realistically be anything that Julia allows, but by convention (and for compatibility with most calculator implementations) we stick to the usual abbreviations for common conditions - <code>:T</code> for temperature, <code>:P</code> for pressure, <code>:V</code> for volume, etc. Each condition profile can be one of three options:</p><ul><li>A <code>Number</code> representing a static value for the given condition to take for the duration of the simulation. Internally this is converted into a <a href="../../api/kinetica/conditions/#Kinetica.StaticConditionProfile"><code>Kinetica.StaticConditionProfile</code></a>, but this is just a container for the number within.</li><li>A directly variable condition profile, e.g. <a href="../../api/kinetica/conditions/#Kinetica.LinearDirectProfile"><code>LinearDirectProfile</code></a>. These are variable condition profiles where the condition is implemented directly as a function of time.</li><li>A gradient-variable condition profile, e.g. <a href="../../api/kinetica/conditions/#Kinetica.LinearGradientProfile"><code>LinearGradientProfile</code></a>. These are variable condition profiles where the condition is implemented indirectly through its gradient with respect to time. These profiles must be numerically integrated (handled automtically within Kinetica) before they can be used.</li></ul><p>The <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a> constructor takes an optional keyword argument, <code>ts_update</code>. If provided, this argument causes any kinetic simulations done with this <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a> to use the discrete rate update approximation, which is usually desired in any moderate to large-scale CRN simulations. For more information, see the tutorial on <a href="../ode-solution/#ODE-Solution">ODE Solution</a>.</p><p>A <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a> which implements static simulation volume, linearly increasing temperature and linearly decreasing pressure with a rate constant update timestep of 1 ms could therefore look like the following:</p><pre><code class="language-julia hljs">conditions = ConditionSet(Dict(
    :V =&gt; 1000.0,
    :T =&gt; LinearDirectProfile(;
        rate = 20.0,
        X_start = 300.0,
        X_end = 500.0
    ),
    :P =&gt; LinearGradientProfile(;
        rate = -50.0,
        X_start = 1e5,
        X_end = 9e4
    )),
    ts_update = tconvert(1.0, &quot;ms&quot;, &quot;s&quot;)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConditionSet{Float64}([:T, :P, :V], Kinetica.AbstractConditionProfile[LinearDirectProfile{Float64, Float64}(Kinetica.var&quot;#f#12&quot;{Float64, Float64, Float64, Float64, Float64}(20.0, 300.0, 500.0, 10.0), 20.0, 300.0, 500.0, 10.0, [0.0, 0.001, 0.002, 0.003, 0.004, 0.005, 0.006, 0.007, 0.008, 0.009  …  9.991, 9.992, 9.993, 9.994, 9.995, 9.996, 9.997, 9.998, 9.999, 10.0], nothing), LinearGradientProfile{Float64, Float64}(Kinetica.var&quot;#grad#17&quot;{Float64, Float64}(-50.0, 200.0), -50.0, 100000.0, 90000.0, 200.0, [0.0, 0.001, 0.002, 0.003, 0.004, 0.005, 0.006, 0.007, 0.008, 0.009  …  199.991, 199.992, 199.993, 199.994, 199.995, 199.996, 199.997, 199.998, 199.999, 200.0], nothing), Kinetica.StaticConditionProfile{Float64}(1000.0)], true, 0.001)</code></pre><div class="admonition is-info"><header class="admonition-header">Converting times</header><div class="admonition-body"><p>By default, Kinetica works in units of seconds (this can be changed within the kinetic calculator being used). While the conversion above may be a bit redundant, the <a href="../../api/kinetica/utilities/#Kinetica.tconvert"><code>tconvert</code></a> function can be used to quickly convert between commonly used time units.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Discrete Rate Approximation Behaviour</header><div class="admonition-body"><p>The behaviour of the <code>ts_update</code> argument is subject to change in the near future. This will likely not be a dramatic change, but it may be worth bearing in mind.</p></div></div><h3 id="Useful-Functions"><a class="docs-heading-anchor" href="#Useful-Functions">Useful Functions</a><a id="Useful-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Useful-Functions" title="Permalink"></a></h3><p>Once constructed, <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a>s can be queried in a number of ways. To fetch any of the profiles within, <a href="../../api/kinetica/conditions/#Kinetica.get_profile-Tuple{ConditionSet, Symbol}"><code>get_profile</code></a> can be called:</p><pre><code class="language-julia hljs">get_profile(conditions, :T)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">LinearDirectProfile{Float64, Float64}(Kinetica.var&quot;#f#12&quot;{Float64, Float64, Float64, Float64, Float64}(20.0, 300.0, 500.0, 10.0), 20.0, 300.0, 500.0, 10.0, [0.0, 0.001, 0.002, 0.003, 0.004, 0.005, 0.006, 0.007, 0.008, 0.009  …  9.991, 9.992, 9.993, 9.994, 9.995, 9.996, 9.997, 9.998, 9.999, 10.0], nothing)</code></pre><p>To test if a given condition is static or variable, the <a href="../../api/kinetica/conditions/#Kinetica.isstatic"><code>isstatic</code></a> and <a href="../../api/kinetica/conditions/#Kinetica.isvariable"><code>isvariable</code></a> funcitons can be called:</p><pre><code class="language-julia hljs">println(&quot;Temperature profile is static: $(isstatic(conditions, :T))&quot;)
println(&quot;Pressure profile is variable: $(isvariable(conditions, :P))&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Temperature profile is static: false
Pressure profile is variable: true</code></pre><p>To get the final time at which all condition profiles have stopped varying, <a href="../../api/kinetica/conditions/#Kinetica.get_t_final-Tuple{ConditionSet}"><code>get_t_final</code></a> can be called. This returns the maximum value of each condition profile&#39;s <code>t_end</code> attribute (see below):</p><pre><code class="language-julia hljs">get_t_final(conditions)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">200.0</code></pre><h2 id="Condition-Profile-Showcase"><a class="docs-heading-anchor" href="#Condition-Profile-Showcase">Condition Profile Showcase</a><a id="Condition-Profile-Showcase-1"></a><a class="docs-heading-anchor-permalink" href="#Condition-Profile-Showcase" title="Permalink"></a></h2><p>Below are the currently implemented variable condition profiles, along with examples of their shapes. Condition profiles are being added as we need them, so this library is currently quite small. You can help us out by adding new profiles and submitting a pull request (see the Development section on <a href="../../development/condition-profiles/#Condition-Profiles">Condition Profiles</a>), or by requesting them to be added on our <a href="https://github.com/Kinetica-jl/Kinetica.jl/issues">Issues page</a>!</p><h3 id="Directly-Variable-Condition-Profiles"><a class="docs-heading-anchor" href="#Directly-Variable-Condition-Profiles">Directly Variable Condition Profiles</a><a id="Directly-Variable-Condition-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Directly-Variable-Condition-Profiles" title="Permalink"></a></h3><h4 id="[LinearDirectProfile](@ref)"><a class="docs-heading-anchor" href="#[LinearDirectProfile](@ref)"><a href="../../api/kinetica/conditions/#Kinetica.LinearDirectProfile"><code>LinearDirectProfile</code></a></a><a id="[LinearDirectProfile](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LinearDirectProfile](@ref)" title="Permalink"></a></h4><p>This profile represents a linear change from one value to another. It has a piecewise linear condition function, defined as follows for the arbitrary condition <span>$X$</span>:</p><p class="math-container">\[X\left( t \right) = 
    \begin{cases}
        \texttt{X\_start}, &amp; \text{if } t \leq 0.0 \\
        \texttt{X\_start} + t\left( \texttt{rate} \right), &amp; \text{if } t &gt; 0.0 \text{ and } t \leq t_{\text{end}} \\
        \texttt{X\_end}, &amp; \text{if } t &gt; t_{\text{end}} \\
    \end{cases}\]</p><p>where <span>$t_{\text{end}} = \left( \texttt{X\_end} - \texttt{X\_start} \right) / \texttt{rate}$</span>. For example:</p><pre><code class="language-julia hljs">cs = ConditionSet(Dict(
    :T =&gt; LinearDirectProfile(;
        X_start = 300.0,
        X_end = 500.0,
        rate=20.0)
))</code></pre><p><img src="../../assets/tutorials/arbitrary_conditions/lineardirectprofile.svg" alt/></p><h3 id="Gradient-Variable-Condition-Profiles"><a class="docs-heading-anchor" href="#Gradient-Variable-Condition-Profiles">Gradient-Variable Condition Profiles</a><a id="Gradient-Variable-Condition-Profiles-1"></a><a class="docs-heading-anchor-permalink" href="#Gradient-Variable-Condition-Profiles" title="Permalink"></a></h3><h4 id="[LinearGradientProfile](@ref)"><a class="docs-heading-anchor" href="#[LinearGradientProfile](@ref)"><a href="../../api/kinetica/conditions/#Kinetica.LinearGradientProfile"><code>LinearGradientProfile</code></a></a><a id="[LinearGradientProfile](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[LinearGradientProfile](@ref)" title="Permalink"></a></h4><p>The gradient-based implementation of <a href="../../api/kinetica/conditions/#Kinetica.LinearDirectProfile"><code>LinearDirectProfile</code></a>. Either can be used, they should be equally accurate. Mostly serves as an example of how gradient profiles differ in implementation to their directly variable counterparts. It has a piecewise linear gradient function, defined as follows for the arbitrary condition <span>$X$</span>:</p><p class="math-container">\[\frac{\mathrm{d} X\left( t \right)}{\mathrm{d}t} = 
    \begin{cases}
        0.0, &amp; \text{if } t \leq 0.0 \\
        \texttt{rate}, &amp; \text{if } t &gt; 0.0 \text{ and } t \leq t_{\text{end}} \\
        0.0, &amp; \text{if } t &gt; t_{\text{end}} \\
    \end{cases}\]</p><p>where <span>$t_{\text{end}} = \left( \texttt{X\_end} - \texttt{X\_start} \right) / \texttt{rate}$</span>. For example:</p><pre><code class="language-julia hljs">cs = ConditionSet(Dict(
    :P =&gt; LinearGradientProfile(;
        X_start = 1e5,
        X_end = 9e4,
        rate=-50.0)
))</code></pre><p><img src="../../assets/tutorials/arbitrary_conditions/lineargradientprofile.svg" alt/></p><h4 id="[DoubleRampGradientProfile](@ref)"><a class="docs-heading-anchor" href="#[DoubleRampGradientProfile](@ref)"><a href="../../api/kinetica/conditions/#Kinetica.DoubleRampGradientProfile"><code>DoubleRampGradientProfile</code></a></a><a id="[DoubleRampGradientProfile](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[DoubleRampGradientProfile](@ref)" title="Permalink"></a></h4><p>This profile represents two linear condition ramps, each of which can have either a positive or a negative gradient, separated by a plateau of variable time. The profile also begins and ends with variable-length condition plateaus to enable equilibration at the initial and final values. It has a piecewise linear gradient function, defined as follows for the arbitrary condition <span>$X$</span>:</p><p class="math-container">\[\frac{\mathrm{d} X\left( t \right)}{\mathrm{d}t} = 
    \begin{cases}
        0.0, &amp; \text{if } t &lt; t_{r1, \text{start}} \\
        \texttt{rate1}, &amp; \text{if } t_{r1, \text{start}} \leq t &lt; t_{r1, \text{end}} \\
        0.0, &amp; \text{if } t_{r1, \text{end}} \leq t &lt; t_{r2, \text{start}} \\
        \texttt{rate2}, &amp; \text{if } t_{r2, \text{start}} \leq t &lt; t_{r2, \text{end}} \\
        0.0, &amp; \text{if } t \geq t_{r2, \text{end}} 
    \end{cases}\]</p><p>where <span>$\texttt{rate1}$</span> and <span>$\texttt{rate2}$</span> are the rates of change of the two linear ramps, and <span>$t_{r1, \text{start}}$</span>, <span>$t_{r1, \text{end}}$</span>, <span>$t_{r2, \text{start}}$</span> and <span>$t_{r2, \text{end}}$</span> are the respective start- and end-times of the first and second ramps, determined by the lengths of the starting, middle and ending plateaus.</p><p>The profile features an optional argument <code>t_blend</code>, which can be used to create smooth transitions between the otherwise discontinuous gradient changes through linear interpolation. For example:</p><pre><code class="language-julia hljs">cs = ConditionSet(Dict(
    :K =&gt; DoubleRampGradientProfile(;
        X_start = 100.0,
        t_start_plateau = 3.0,
        rate1 = 10.0,
        X_mid = 250.0,
        t_mid_plateau = 5.0,
        rate2 = -25.0,
        X_end = 50.0,
        t_end_plateau = 10.0,
        t_blend = 0.5)
))</code></pre><p><img src="../../assets/tutorials/arbitrary_conditions/doublerampgradientprofile.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../getting-started/">« Getting Started</a><a class="docs-footer-nextpage" href="../ode-solution/">ODE Solution »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 25 March 2024 12:14">Monday 25 March 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
