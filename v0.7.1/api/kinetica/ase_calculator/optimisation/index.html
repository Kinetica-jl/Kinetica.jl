<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimisation · Kinetica.jl</title><meta name="title" content="Optimisation · Kinetica.jl"/><meta property="og:title" content="Optimisation · Kinetica.jl"/><meta property="twitter:title" content="Optimisation · Kinetica.jl"/><meta name="description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="og:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="twitter:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><script data-outdated-warner src="../../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../../assets/documenter.js"></script><script src="../../../../search_index.js"></script><script src="../../../../siteinfo.js"></script><script src="../../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../../assets/themeswap.js"></script><link href="../../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../../"><img src="../../../../assets/logo.svg" alt="Kinetica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../../">Kinetica.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../../">Home</a></li><li><a class="tocitem" href="../../../../getting-started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../../../tutorials/arbitrary-conditions/">Arbitrary Simulation Conditions</a></li><li><a class="tocitem" href="../../../../tutorials/ode-solution/">ODE Solution</a></li><li><a class="tocitem" href="../../../../tutorials/kinetic-calculators/">Kinetic Calculators</a></li><li><a class="tocitem" href="../../../../tutorials/iterative-exploration/">Iterative CRN Exploration</a></li><li><a class="tocitem" href="../../../../tutorials/results-analysis/">Results Analysis</a></li><li><a class="tocitem" href="../../../../tutorials/filtering-crns/">Filtering CRNs</a></li><li><a class="tocitem" href="../../../../tutorials/saving-loading/">Saving &amp; Loading</a></li><li><a class="tocitem" href="../../../../tutorials/logging/">Logging</a></li></ul></li><li><span class="tocitem">Developing with Kinetica</span><ul><li><a class="tocitem" href="../../../../development/crn-representation/">CRN Representation</a></li><li><a class="tocitem" href="../../../../development/condition-profiles/">Condition Profiles</a></li><li><a class="tocitem" href="../../../../development/calculator-interface/">Calculator Interface</a></li><li><a class="tocitem" href="../../../../development/ase-calculator-builders/">ASE Calculator Builders</a></li><li><a class="tocitem" href="../../../../development/implementation-details/">Implementation Details</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox" checked/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Kinetica.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../exploration/">Exploration</a></li><li><a class="tocitem" href="../../solving/">Solving</a></li><li><a class="tocitem" href="../../conditions/">Conditions</a></li><li><a class="tocitem" href="../../analysis/">Analysis</a></li><li><a class="tocitem" href="../../openbabel/">Open Babel</a></li><li><a class="tocitem" href="../../rdkit/">RDKit</a></li><li><a class="tocitem" href="../../utilities/">Utilities</a></li><li><input class="collapse-toggle" id="menuitem-5-1-8" type="checkbox" checked/><label class="tocitem" for="menuitem-5-1-8"><span class="docs-label">ASE Interface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calculator/">Kinetic Calculator</a></li><li class="is-active"><a class="tocitem" href>Optimisation</a><ul class="internal"><li><a class="tocitem" href="#Optimisation-and-Property-Calculation"><span>Optimisation and Property Calculation</span></a></li></ul></li><li><a class="tocitem" href="../builders/">Builders</a></li><li><a class="tocitem" href="../utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../autode/">autodE Interface</a></li></ul></li><li><a class="tocitem" href="../../../kineticakpm/">KineticaKPM.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Kinetica.jl</a></li><li><a class="is-disabled">ASE Interface</a></li><li class="is-active"><a href>Optimisation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimisation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Kinetica.jl-API-ASE-Interface"><a class="docs-heading-anchor" href="#Kinetica.jl-API-ASE-Interface">Kinetica.jl API - ASE Interface</a><a id="Kinetica.jl-API-ASE-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Kinetica.jl-API-ASE-Interface" title="Permalink"></a></h1><h2 id="Optimisation-and-Property-Calculation"><a class="docs-heading-anchor" href="#Optimisation-and-Property-Calculation">Optimisation and Property Calculation</a><a id="Optimisation-and-Property-Calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Optimisation-and-Property-Calculation" title="Permalink"></a></h2><h3 id="Basic-Species-Properties"><a class="docs-heading-anchor" href="#Basic-Species-Properties">Basic Species Properties</a><a id="Basic-Species-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Species-Properties" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_mult" href="#Kinetica.get_mult"><code>Kinetica.get_mult</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mult(sd::SpeciesData, sid)</code></pre><p>Calculates the spin multiplicity of the species in <code>sd</code> at ID <code>sid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_mult!" href="#Kinetica.get_mult!"><code>Kinetica.get_mult!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mult!(sd::SpeciesData, sid)</code></pre><p>Caches the spin multiplicity of the species in <code>sd</code> at ID <code>sid</code> in <code>sd.cache[:mult]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_charge" href="#Kinetica.get_charge"><code>Kinetica.get_charge</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_charge(sd::SpeciesData, sid)</code></pre><p>Calculates the charge of the species in <code>sd</code> at ID <code>sid</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L25-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_charge!" href="#Kinetica.get_charge!"><code>Kinetica.get_charge!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_charge!(sd::SpeciesData, sid)</code></pre><p>Caches the charge of the species in <code>sd</code> at ID <code>sid</code> in <code>sd.cache[:charge]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L32-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_formal_charges" href="#Kinetica.get_formal_charges"><code>Kinetica.get_formal_charges</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_formal_charges(amsmi::String)
get_formal_charges(sd::SpeciesData, sid)</code></pre><p>Calculates formal charges on each atom of a species.</p><p>Can be given an atom-mapped SMILES <code>amsmi</code> to calculate from, or a species in <code>sd</code> at ID <code>sid</code>, in which case the atom-mapped SMILES is calculated on-the-fly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L40-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_formal_charges!" href="#Kinetica.get_formal_charges!"><code>Kinetica.get_formal_charges!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_formal_charges!(sd::SpeciesData, sid)</code></pre><p>Caches the formal charges of the species in <code>sd</code> at ID <code>sid</code> in <code>sd.cache[:formal_charges]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L60-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_initial_magmoms" href="#Kinetica.get_initial_magmoms"><code>Kinetica.get_initial_magmoms</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_initial_magmoms(amsmi::String)
get_initial_magmoms(sd::SpeciesData, sid)</code></pre><p>Calculates initial magnetic moments on each atom of a species.</p><p>Can be given an atom-mapped SMILES <code>amsmi</code> to calculate from, or a species in <code>sd</code> at ID <code>sid</code>, in which case the atom-mapped SMILES is calculated on-the-fly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L68-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_initial_magmoms!" href="#Kinetica.get_initial_magmoms!"><code>Kinetica.get_initial_magmoms!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_initial_magmoms!(sd::SpeciesData, sid)</code></pre><p>Caches the initial magnetic moments of the species in <code>sd</code> at ID <code>sid</code> in <code>sd.cache[:initial_magmoms]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L91-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.correct_magmoms_for_mult!" href="#Kinetica.correct_magmoms_for_mult!"><code>Kinetica.correct_magmoms_for_mult!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correct_magmoms_for_mult(reac_magmoms::Vector{Float64}, prod_magmoms::Vector{Float64}, mult::Int)</code></pre><p>Identifies a set of initial magnetic moments that are consistent with spin multiplicity <code>mult</code> across a whole reaction.</p><p>As single-reference electronic structure methods cannot  handle switching of electronic states along a NEB path, a consistent multiplicity must be used. In cases where initial magnetic moments are needed, these must be consistent with the mult for both the reactant and  product systems.</p><p>Attempts to correct existing magmoms by initially flipping lone radical electrons, e.g. by converting a dissociated system of two monoradicals to be a spin up-spin down pair with total mult of 1 to match with a singlet-state reactant. If this cannot be achieved, resorts to flipping half of an electron pair, e.g. by converting singlet carbene to triplet carbene.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L99-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_hydrogen_idxs" href="#Kinetica.get_hydrogen_idxs"><code>Kinetica.get_hydrogen_idxs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_hydrogen_idxs(amsmi::String)</code></pre><p>Returns indices of hydrogen atoms in atom-mapped SMILES <code>amsmi</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L327-L331">source</a></section></article><h3 id="Geometry-Optimisation"><a class="docs-heading-anchor" href="#Geometry-Optimisation">Geometry Optimisation</a><a id="Geometry-Optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry-Optimisation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.geomopt!" href="#Kinetica.geomopt!"><code>Kinetica.geomopt!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">geomopt!(sd::SpeciesData, i, calc_builder[, calcdir::String=&quot;./&quot;, optimiser=&quot;LBFGSLineSearch&quot;, 
         fmax=0.01, maxiters=nothing, check_isomorphic=true, kwargs...])
geomopt!(frame::Dict{String, Any}, calc_builder[, calcdir::String=&quot;./&quot;, mult::Int=1, 
         chg::Int=0, formal_charges=nothing, initial_magmoms=nothing, 
         optimiser=&quot;BFGSLineSearch&quot;, fmax=0.01, maxiters=1000, check_isomorphic=true, 
         kwargs...])</code></pre><p>Runs an ASE-driven geometry optimisation of the species in <code>frame</code>.</p><p>Can be run directly from a <code>frame</code>, or a <code>frame</code> can be extracted from <code>sd.xyz[i]</code> in theh case of the second method. With this method, formal charges, total charge and spin multiplicity are assumed to have been calculated and cached in <code>sd.cache</code>. When running directly from a <code>frame</code>, this information must be passed manually.</p><p><code>calc_builder</code> should be a struct with a functor that returns a correctly constructed ASE calculator for the system at hand. While ASE can handle many system-specific calculator details from an <code>Atoms</code> object, quantities such as spin multiplicity and sometimes charge must be input separately. For this reason, the <code>calc_builder</code> functor must take <code>mult::Int</code> and <code>charge::Int</code> as its first two arguments. Any other arguments can be passed via this method&#39;s <code>kwargs</code>.</p><p>Some ASE calculators handle charged species at the <code>Atoms</code> level. These require an array of formal charges on each atom to be given during <code>Atoms</code> construction. If <code>formal_charges</code> is provided, this will occur. If not, all formal charges will be  assumed to be zero. </p><p>IMPORTANTLY, any <code>formal_charges</code> array MUST match the atom ordering of the provided <code>frame</code>. This can by calling  <code>get_formal_charges</code> on an atom-mapped SMILES from <code>atom_map_smiles</code>.</p><p>This optimisation always uses one of ASE&#39;s optimisers out of &quot;BFGSLineSearch&quot;, &quot;fire&quot;, &quot;bfgs&quot; or &quot;lbfgs&quot;. The maximum force <code>fmax</code> and maximum number of iterations <code>maxiters</code> that this optimiser converges with can also be controlled.</p><p>Directly modifies the atomic positions and energy of the passed in <code>frame</code>. Energies returned are in eV. Returns a boolean for whether the optimisation was a conv.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L189-L232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.kabsch_fit!" href="#Kinetica.kabsch_fit!"><code>Kinetica.kabsch_fit!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kabsch_fit!(frame1::Dict{String, Any}, frame2::Dict{String, Any})</code></pre><p>Computes the maximum overlap of atoms within <code>frame1</code> to <code>frame2</code>.</p><p>Modifies the atomic positions in <code>frame1</code> to be as close as possible to those in <code>frame2</code> through a combination of translation and rotation. Uses the Kabsch algorithm, as implemented in the Python package &#39;rmsd&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L309-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.permute_hydrogens!" href="#Kinetica.permute_hydrogens!"><code>Kinetica.permute_hydrogens!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">permute_hydrogens!(frame1::Dict{String, Any}, hidxs::Vector{Vector{Int}}, frame2::Dict{String, Any})</code></pre><p>Corrects erroneous RDKit atom-mapping on hydrogen atoms.</p><p>Due to the implicit handling of hydrogens in RDKit, they can sometimes receive incorrect atom mapping duing conversion of a geometry to atom-mapped SMILES. This can cause additional bond breakage or rotation over the course of a NEB calculation.</p><p>This is fixed by permuting every pair of hydrogen atoms in <code>frame1</code> (usually a reactant geometry) and comparing whether the positional RMSD between it and <code>frame2</code> (a product geometry) decreases. If this is the case, the permutation is made permanent.</p><p>This process repeats over all hydrogens in a system until no more permutations are accepted, indicating the atom mapping with the least likelihood to cause NEB problems has been found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/optimise.jl#L357-L375">source</a></section></article><h3 id="NEB"><a class="docs-heading-anchor" href="#NEB">NEB</a><a id="NEB-1"></a><a class="docs-heading-anchor-permalink" href="#NEB" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_initial_sys_mult" href="#Kinetica.get_initial_sys_mult"><code>Kinetica.get_initial_sys_mult</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_initial_sys_mult(mults)</code></pre><p>Returns the combined spin multiplicity of a system of molecules.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/neb.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.get_rxn_mult" href="#Kinetica.get_rxn_mult"><code>Kinetica.get_rxn_mult</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_rxn_mult(n_reacs::Int, rmult::Int, n_prods::Int, pmult::Int)
get_rxn_mult(reacsys::Dict{String, Any}, prodsys::Dict{String, Any})</code></pre><p>Chooses a spin multiplicity to apply over a whole reaction given reactant and product multiplicities.</p><p>Given an addition (2-&gt;1) or a dissociation (1-&gt;2), picks the mult on the side with the fewest species, as this usually results in the species that are expected to be more stable (reactants for dissociation, products for association) being in their most stable electronic configuration.</p><p>Given a substitution (2-&gt;2) or a rearrangement (1-&gt;1), the mult should always be balanced. However, abstractions from radicals can lead to unbalanced mult, e.g. [CH2]C + [H] –&gt; C=C + [H][H], in which case the lower mult should be taken. There are also rare cases involving carbenes that may be unbalanced, e.g. [CH]C –&gt; C=C, in which case the lower mult should also be taken.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/neb.jl#L9-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.neb" href="#Kinetica.neb"><code>Kinetica.neb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">neb(reacsys, prodsys, calc::ASENEBCalculator[, calcdir=&quot;./&quot;, kwargs...])</code></pre><p>Interpolates and runs (CI-)NEB for the reaction defined by endpoints <code>reacsys</code> and <code>prodsys</code>.</p><p>Given ExtXYZ frames for reactants and products <code>reacsys</code> and <code>prodsys</code> respectively, performs an interpolation to generate an initial reaction path and then optimises it with ASE&#39;s NEB implementation.</p><p>Interpolation scheme is selected by <code>calc.interpolation</code>,  where <code>&quot;linear&quot;</code> and <code>&quot;idpp&quot;</code> are the currently available options.</p><p>NEB optimisation is performed by the optimiser defined in <code>calc.neb_optimiser</code>. If <code>calc.climb=false</code>, runs a regular NEB calculation until maximum force is less than <code>calc.ftol</code>. If <code>calc.climb=true</code>, runs a regular NEB calculation until maximum force is less than <code>calc.climb_ftol</code>, then enables CINEB and runs until maximum force is less than <code>calc.ftol</code>. Each optimisation only runs until <code>calc.maxiters</code> iterations have elapsed.</p><p><code>kwargs</code> are passed to the Kinetica calculator builder.</p><p>Returns the optimised NEB path as a Python list of ASE Atoms objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/neb.jl#L47-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.highest_energy_frame" href="#Kinetica.highest_energy_frame"><code>Kinetica.highest_energy_frame</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">highest_energy_frame(images::Py)</code></pre><p>Finds the highest energy NEB image in <code>images</code>, returns as a frame.</p><p><code>images</code> should be a Python list of ASE Atoms objects representing a NEB path (see the <code>neb(reacsys, prodsys, calc)</code> method). Locates the highest energy image, converts it to an ExtXYZ frame and returns this frame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/neb.jl#L156-L165">source</a></section></article><h3 id="Vibrational-Analysis"><a class="docs-heading-anchor" href="#Vibrational-Analysis">Vibrational Analysis</a><a id="Vibrational-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Vibrational-Analysis" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.calc_species_vibrations!" href="#Kinetica.calc_species_vibrations!"><code>Kinetica.calc_species_vibrations!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_species_vibrations(sd::SpeciesData, sid, calc_builder[, calcdir=&quot;./&quot;, refresh=false, delta=0.01, ivetol=0.1, kwargs...])</code></pre><p>Calculates vibrational energies of a species.</p><p>Given a species with an optimised geometry in <code>sd.xyz[sid]</code>, uses ASE to calculate vibrational energies with a finite difference approximation of its Hessian, using the ASE calculator constructed through <code>calc_builder</code>.</p><p>Writes the vibrational energies in eV as an array into  <code>sd.cache[:vib_energies]</code>. Defaults to not overwriting  already calculated vibrational energies for a species, instead returnong immediately. If recalculations are desired, use <code>refresh=true</code>. </p><p>If a species has imaginary frequencies, these can be ignored below a vibrational energy threshold <code>ivetol</code>, which removes them from the final vibrational energy array. All imaginary frequencies can be ignored by passing <code>ivetol=0.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/vibrations.jl#L1-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Kinetica.calc_ts_vibrations!" href="#Kinetica.calc_ts_vibrations!"><code>Kinetica.calc_ts_vibrations!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_ts_vibrations(ts_cache::Dict{Symbol, Any}, rid, calc_builder[, calcdir=&quot;./&quot;, delta=0.01, ivetol=0.1, kwargs...])</code></pre><p>Calculates vibrational energies of a transition state.</p><p>Given a TS with an optimised geometry in <code>ts_cache[:xyz][rid]</code>, uses ASE to calculate vibrational energies with a finite  difference apporoximation of its Hessian, using the ASE calculator constructed through <code>calc_builder</code>.</p><p>Writes the vibrational energies in eV as an array into  <code>ts_cache[:vib_energies]</code>.</p><p>If a species has imaginary frequencies, these can be ignored below a vibrational energy threshold <code>ivetol</code>, which removes them from the final vibrational energy array. All imaginary frequencies can be ignored by passing <code>ivetol=0.0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/aee1bb09ad92258fdc8628922bf32a74999db36a/src/ase/vibrations.jl#L73-L91">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../calculator/">« Kinetic Calculator</a><a class="docs-footer-nextpage" href="../builders/">Builders »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Thursday 8 May 2025 16:40">Thursday 8 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
