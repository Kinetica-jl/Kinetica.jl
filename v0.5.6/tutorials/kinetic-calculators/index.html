<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Kinetic Calculators · Kinetica.jl</title><meta name="title" content="Kinetic Calculators · Kinetica.jl"/><meta property="og:title" content="Kinetic Calculators · Kinetica.jl"/><meta property="twitter:title" content="Kinetic Calculators · Kinetica.jl"/><meta name="description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="og:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="twitter:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Kinetica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Kinetica.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../arbitrary-conditions/">Arbitrary Simulation Conditions</a></li><li><a class="tocitem" href="../ode-solution/">ODE Solution</a></li><li class="is-active"><a class="tocitem" href>Kinetic Calculators</a><ul class="internal"><li><a class="tocitem" href="#Manually-Calling-Calculators"><span>Manually Calling Calculators</span></a></li><li><a class="tocitem" href="#Calculator-Showcase"><span>Calculator Showcase</span></a></li></ul></li><li><a class="tocitem" href="../iterative-exploration/">Iterative CRN Exploration</a></li><li><a class="tocitem" href="../results-analysis/">Results Analysis</a></li><li><a class="tocitem" href="../filtering-crns/">Filtering CRNs</a></li><li><a class="tocitem" href="../saving-loading/">Saving &amp; Loading</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><span class="tocitem">Developing with Kinetica</span><ul><li><a class="tocitem" href="../../development/crn-representation/">CRN Representation</a></li><li><a class="tocitem" href="../../development/condition-profiles/">Condition Profiles</a></li><li><a class="tocitem" href="../../development/calculator-interface/">Calculator Interface</a></li><li><a class="tocitem" href="../../development/implementation-details/">Implementation Details</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Kinetica.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/exploration/">Exploration</a></li><li><a class="tocitem" href="../../api/kinetica/solving/">Solving</a></li><li><a class="tocitem" href="../../api/kinetica/conditions/">Conditions</a></li><li><a class="tocitem" href="../../api/kinetica/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/kinetica/openbabel/">Open Babel</a></li><li><a class="tocitem" href="../../api/kinetica/rdkit/">RDKit</a></li><li><a class="tocitem" href="../../api/kinetica/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/kineticakpm/">KineticaKPM.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Kinetic Calculators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Kinetic Calculators</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl/blob/main/docs/src/tutorials/kinetic-calculators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Kinetic-Calculators"><a class="docs-heading-anchor" href="#Kinetic-Calculators">Kinetic Calculators</a><a id="Kinetic-Calculators-1"></a><a class="docs-heading-anchor-permalink" href="#Kinetic-Calculators" title="Permalink"></a></h1><p>Kinetica allows for any and all rate constant expressions to be used within kinetic simulations through its modular kinetic calculator interface. This allows users and developers alike to quickly define a set of functions which are dependent on a CRN (through a <a href="../../api/kinetica/exploration/#Kinetica.SpeciesData"><code>SpeciesData</code></a> and an <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a>) and some arbitrary experimental conditions which the simulation takes place under, such as temperature and pressure, and to calculate rate constants. For more information on how kinetic calculators are implemented, see <a href="../../development/calculator-interface/#Calculator-Interface">Calculator Interface</a>.</p><p>Kinetica features a single base calculator, the <a href="../../api/kinetica/solving/#Kinetica.PrecalculatedArrheniusCalculator"><code>PrecalculatedArrheniusCalculator</code></a>. This calculator relies on having Arrhenius prefactors and activation energies precalculated for every reaction in a CRN, and serves mostly as a test calculator and an implementation example. </p><p>Other more useful calculators are provided as modular addon packages that extend Kinetica.jl (e.g. KineticaKPM.jl). Some calculators have extensive dependencies, so this modularisation allows for picking and choosing only the calculators required for a specific project rather than having every available calculator in one bloated Julia/Python environment.</p><h2 id="Manually-Calling-Calculators"><a class="docs-heading-anchor" href="#Manually-Calling-Calculators">Manually Calling Calculators</a><a id="Manually-Calling-Calculators-1"></a><a class="docs-heading-anchor-permalink" href="#Manually-Calling-Calculators" title="Permalink"></a></h2><p>The examples below all show how calculators can be manually called to calculate rate constants. This is useful when these values are required, e.g. for analysis, but is not required during kinetic simulations. Passing a calculator into <a href="../../api/kinetica/exploration/#Kinetica.explore_network"><code>explore_network</code></a> or <a href="../../api/kinetica/solving/#Kinetica.solve_network"><code>solve_network</code></a> via a <a href="../../api/kinetica/solving/#Kinetica.VariableODESolve"><code>VariableODESolve</code></a> struct (see the <a href="../../getting-started/#Running-the-Simulation">&#39;Running the Simulation&#39; section of Getting Started</a>) is enough to set up the calculator and evaluate rate constants as many times as is required by the simulation.</p><p>In the event that a calculator is required to be called manually, the process is very simple. Once the calculator has been instantiated, it should be passed to its <code>setup_network!</code> method. All kinetic calculators implement such a function, which checks the values provided to the calculator are compatible with a given <a href="../../api/kinetica/exploration/#Kinetica.SpeciesData"><code>SpeciesData</code></a> and <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a> and does any necessary pre-calculation such that the calculator can perform the minimum computation when rate constants are requested. Once setup, the calculator object can be called as a functor with its implemented experimental conditions as keyword arguments to evaluate the rate constants of all reactions in the given CRN at the provided values of the conditions. Examples of this process can be found below.</p><h2 id="Calculator-Showcase"><a class="docs-heading-anchor" href="#Calculator-Showcase">Calculator Showcase</a><a id="Calculator-Showcase-1"></a><a class="docs-heading-anchor-permalink" href="#Calculator-Showcase" title="Permalink"></a></h2><p>In all of the examples below, <code>sd</code> and <code>rd</code> refer to instances of <a href="../../api/kinetica/exploration/#Kinetica.SpeciesData"><code>SpeciesData</code></a> and <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a> respectively. These are the internal representations of species and reactions within Kinetica, see the page on <a href="../../api/kinetica/exploration/#CRN-Representation">CRN Representation</a> for further information.</p><div class="admonition is-info"><header class="admonition-header">This section is growing!</header><div class="admonition-body"><p>Kinetica currently has only a handful of kinetic calculators available. We are adding more as we need them, but if you require a specific implementation then please let us know on our <a href="https://github.com/Kinetica-jl/Kinetica.jl/issues">Issues page</a>. Alternatively, calculators aren&#39;t too hard to implement yourself, and custom calculators can be dropped into kinetic simulations just like the ones presented here. See <a href="../../development/calculator-interface/#Calculator-Interface">Calculator Interface</a> for details.</p></div></div><h3 id="Kinetica.jl"><a class="docs-heading-anchor" href="#Kinetica.jl">Kinetica.jl</a><a id="Kinetica.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Kinetica.jl" title="Permalink"></a></h3><h4 id="[PrecalculatedArrheniusCalculator](@ref)"><a class="docs-heading-anchor" href="#[PrecalculatedArrheniusCalculator](@ref)"><a href="../../api/kinetica/solving/#Kinetica.PrecalculatedArrheniusCalculator"><code>PrecalculatedArrheniusCalculator</code></a></a><a id="[PrecalculatedArrheniusCalculator](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[PrecalculatedArrheniusCalculator](@ref)" title="Permalink"></a></h4><p>This calculator is dependent on temperature as an experimental condition, and takes a vector of Arrhenius prefactors and a vector of activation energies, each with an entry for each reaction in a given CRN, and calculates rate constants with the Arrhenius equation. It also accepts an optional maximum rate constant <code>k_max</code> which takes over through partial diffusion control. The calculated rate constant for reaction <span>$i$</span> is therefore: </p><p class="math-container">\[k_i = \dfrac{1}{\dfrac{1}{k_{\text{max}}} + \dfrac{1}{A_ie^{-\dfrac{E_i}{RT}}}}\]</p><p>where <span>$A_i$</span> is the <span>$i$</span>th Arrhenius prefactor, <span>$E_i$</span> is the <span>$i$</span>th activation energy, <span>$R$</span> is the ideal gas constant and <span>$T$</span> is the temperature, which must be passed in as a parameter.</p><h5 id="Example:"><a class="docs-heading-anchor" href="#Example:">Example:</a><a id="Example:-1"></a><a class="docs-heading-anchor-permalink" href="#Example:" title="Permalink"></a></h5><pre><code class="language-julia hljs"># Get Arrhenius prefactors A and activation energies Ea from elsewhere...
# Length of A and Ea should match rd.nr.
calc = PrecalculatedArrheniusCalculator(Ea, A; k_max = 1e12)
setup_network!(sd, rd, calc)
k = calc(; T = 300.0)</code></pre><h3 id="KineticaKPM.jl"><a class="docs-heading-anchor" href="#KineticaKPM.jl">KineticaKPM.jl</a><a id="KineticaKPM.jl-1"></a><a class="docs-heading-anchor-permalink" href="#KineticaKPM.jl" title="Permalink"></a></h3><p>The calculators in KineticaKPM all use <a href="https://github.com/joegilkes/KineticPredictorModel">KineticPredictorModel</a> (KPM), a Python code for predicting activation energies using a simple neural network, as a driver for rate constant calculation using the Arrhenius equation. Arrhenius prefactors are estimated through a variety of methods depending on the calculator used.</p><p>The calculators in this package require an instance of <a href="../../api/kineticakpm/#KineticaKPM.KPMRun"><code>KPMRun</code></a>, which acts as an interface to the KPM package and handles conversion of the current CRN into reactions which it can predict activation energies for. This is simply constructed by calling the following:</p><pre><code class="language-julia hljs">kpm = KPMRun(&quot;/path/to/kpm_model.npz&quot;)</code></pre><p>where the KPM model <code>.npz</code> file should be obtained separately through training a model with the main Python package.</p><p>All calculators in this package accept an optional maximum rate constant <code>k_max</code> which takes over through partial diffusion control. They are also all capable of returning rate constants with <a href="https://juliaphysics.github.io/Measurements.jl/stable/">Measurements.jl</a> uncertainties, derived from the standard deviation between activation energy predictions within an ensemble of neural networks. While these can be used manually, they are not currently supported within any of the ODE solution methods in Kinetica.</p><h4 id="[KPMBasicCalculator](@ref)"><a class="docs-heading-anchor" href="#[KPMBasicCalculator](@ref)"><a href="../../api/kineticakpm/#KineticaKPM.KPMBasicCalculator"><code>KPMBasicCalculator</code></a></a><a id="[KPMBasicCalculator](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[KPMBasicCalculator](@ref)" title="Permalink"></a></h4><p>This calculator is dependent on temperature as an experimental condition. It estimates Arrhenius prefactors as</p><p class="math-container">\[A = \dfrac{RT}{h}\]</p><p>for all reactions, where <span>$R$</span> is the ideal gas constant, <span>$T$</span> is the temperature, which must be passed as a parameter, and <span>$h$</span> is the Planck constant. The resulting rate constant for reaction <span>$i$</span> is therefore:</p><p class="math-container">\[k_i = \dfrac{1}{\dfrac{1}{k_{\text{max}}} + \dfrac{1}{\dfrac{RT}{h}e^{-\dfrac{E_i}{RT}}}}.\]</p><h5 id="Example:-2"><a class="docs-heading-anchor" href="#Example:-2">Example:</a><a class="docs-heading-anchor-permalink" href="#Example:-2" title="Permalink"></a></h5><pre><code class="language-julia hljs"># Set up KPMRun object before this...
calc = KPMBasicCalculator(kpm; uncertainty = false, k_max = 1e12)
setup_network!(sd, rd, calc)
k = calc(; T = 300.0)</code></pre><h4 id="[KPMCollisionCalculator](@ref)"><a class="docs-heading-anchor" href="#[KPMCollisionCalculator](@ref)"><a href="../../api/kineticakpm/#KineticaKPM.KPMCollisionCalculator"><code>KPMCollisionCalculator</code></a></a><a id="[KPMCollisionCalculator](@ref)-1"></a><a class="docs-heading-anchor-permalink" href="#[KPMCollisionCalculator](@ref)" title="Permalink"></a></h4><p>This calculator is dependent on temperature as an experimental condition. It estimates Arrhenius prefactors using collision theory, a hard-sphere approximation of collision frequency. All unimolecular reactions therefore require a collision partner for reactions to occur, which can be passed through the <code>inert_species</code> argument. If this is given, <code>setup_network!</code> will modify all unimolecular reactions to become bimolecular with the provided collision partners. Otherwise, an average collision partner will be calculated from the species in the CRN and rates will be calculated assuming a concentration of 1 mol dm<span>$^{-3}$</span> of this &#39;species&#39;.</p><p>The calculator computes two properties for each reaction: the reduced mass <span>$\mu$</span> and the collision cross section <span>$\sigma$</span>. For collision partners <span>$A$</span> and <span>$B$</span>, these are defined as</p><p class="math-container">\[\mu = \dfrac{m_A m_B}{m_A + m_B} \\
\sigma = \pi \left( r_A + r_B \right)^2\]</p><p>where <span>$m_A$</span> and <span>$m_B$</span> are the masses of <span>$A$</span> and <span>$B$</span> respectively and <span>$r_A$</span> and <span>$r_B$</span> are the hard sphere radii of <span>$A$</span> and <span>$B$</span> respectively.</p><p>The calculator optionally allows for specification of a &#39;steric factor&#39; <span>$\rho$</span>. Collision theory is known to overestimate rate constants, but there is no perfect mathematical relationship that can calculate how much this overestimate is by. The steric factors implemented here attempt to establish an empirical correction to the collision theory rate constant based on a variety of information about each species. See <a href="../../api/kineticakpm/#KineticaKPM.calc_steric_factors"><code>KineticaKPM.calc_steric_factors</code></a> for further information.</p><p>The resulting rate constant for reaction <span>$i$</span> is therefore:</p><p class="math-container">\[k_i = \dfrac{1}{\dfrac{1}{k_{\text{max}}} + \dfrac{1}{\sigma_i \rho_i N_A \sqrt{\dfrac{8 k_b T}{\pi \mu_i}}e^{-\dfrac{E_i}{RT}}}}\]</p><p>where <span>$N_A$</span> is Avogadro&#39;s number, <span>$k_b$</span> is the Boltzmann constant, <span>$T$</span> is the temperature, which is passed as a parameter, <span>$E_i$</span> is the activation energy and <span>$R$</span> is the ideal gas constant.</p><h5 id="Example:-3"><a class="docs-heading-anchor" href="#Example:-3">Example:</a><a class="docs-heading-anchor-permalink" href="#Example:-3" title="Permalink"></a></h5><pre><code class="language-julia hljs"># If using inert species, these need an initial concentration.
pars = ODESimulationParams(
    tspan = (0.0, 10.0)
    u0 = Dict(
        &quot;CC&quot; =&gt; 1.0,
        &quot;N#N&quot; =&gt; 1.0
    ),
    solver = ...
)
# Set up KPMRun object before this...
calc = KPMCollisionCalculator(
    kpm,
    inert_species = [&quot;N#N&quot;],
    steric_factor = :basic,
    uncertainty = false,
    k_max = 1e12
)
setup_network!(sd, rd, calc)
k = calc(; T = 300.0)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ode-solution/">« ODE Solution</a><a class="docs-footer-nextpage" href="../iterative-exploration/">Iterative CRN Exploration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.0 on <span class="colophon-date" title="Monday 22 April 2024 21:35">Monday 22 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
