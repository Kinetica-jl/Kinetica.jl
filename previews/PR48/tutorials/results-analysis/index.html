<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Results Analysis · Kinetica.jl</title><meta name="title" content="Results Analysis · Kinetica.jl"/><meta property="og:title" content="Results Analysis · Kinetica.jl"/><meta property="twitter:title" content="Results Analysis · Kinetica.jl"/><meta name="description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="og:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="twitter:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Kinetica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Kinetica.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../arbitrary-conditions/">Arbitrary Simulation Conditions</a></li><li><a class="tocitem" href="../ode-solution/">ODE Solution</a></li><li><a class="tocitem" href="../kinetic-calculators/">Kinetic Calculators</a></li><li><a class="tocitem" href="../iterative-exploration/">Iterative CRN Exploration</a></li><li class="is-active"><a class="tocitem" href>Results Analysis</a><ul class="internal"><li><a class="tocitem" href="#Analysing-the-CRN"><span>Analysing the CRN</span></a></li><li><a class="tocitem" href="#Analysing-the-Kinetic-Simulation"><span>Analysing the Kinetic Simulation</span></a></li></ul></li><li><a class="tocitem" href="../filtering-crns/">Filtering CRNs</a></li><li><a class="tocitem" href="../saving-loading/">Saving &amp; Loading</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><span class="tocitem">Developing with Kinetica</span><ul><li><a class="tocitem" href="../../development/crn-representation/">CRN Representation</a></li><li><a class="tocitem" href="../../development/condition-profiles/">Condition Profiles</a></li><li><a class="tocitem" href="../../development/calculator-interface/">Calculator Interface</a></li><li><a class="tocitem" href="../../development/ase-calculator-builders/">ASE Calculator Builders</a></li><li><a class="tocitem" href="../../development/implementation-details/">Implementation Details</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Kinetica.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/exploration/">Exploration</a></li><li><a class="tocitem" href="../../api/kinetica/solving/">Solving</a></li><li><a class="tocitem" href="../../api/kinetica/conditions/">Conditions</a></li><li><a class="tocitem" href="../../api/kinetica/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/kinetica/openbabel/">Open Babel</a></li><li><a class="tocitem" href="../../api/kinetica/rdkit/">RDKit</a></li><li><a class="tocitem" href="../../api/kinetica/utilities/">Utilities</a></li><li><input class="collapse-toggle" id="menuitem-5-1-8" type="checkbox"/><label class="tocitem" for="menuitem-5-1-8"><span class="docs-label">ASE Interface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/ase_calculator/calculator/">Kinetic Calculator</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/optimisation/">Optimisation</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/builders/">Builders</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/kinetica/autode/">autodE Interface</a></li></ul></li><li><a class="tocitem" href="../../api/kineticakpm/">KineticaKPM.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Results Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Results Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Results-Analysis"><a class="docs-heading-anchor" href="#Results-Analysis">Results Analysis</a><a id="Results-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Results-Analysis" title="Permalink"></a></h1><p>Upon completion of a kinetic simulation run by <a href="../../api/kinetica/solving/#Kinetica.solve_network"><code>solve_network</code></a> (or through the end of a CRN exploration using <a href="../../api/kinetica/exploration/#Kinetica.explore_network"><code>explore_network</code></a>, which also calls this function), Kinetica returns an <a href="../../api/kinetica/analysis/#Kinetica.ODESolveOutput"><code>ODESolveOutput</code></a> object. This binds together the CRN that this simulation was run on (after modifications such as those described in <a href="../filtering-crns/#Filtering-CRNs">Filtering CRNs</a> and <a href="../../development/implementation-details/#implementation_low_rate">Removing Low-Rate Reactions</a>), the parameters the simulation was run with, and the simulation&#39;s results. This data can be used for analysing the results of a kinetic simulation.</p><p>We will demonstrate this analysis using the results of the CRN we generated and simulated in <a href="../../getting-started/#Getting-Started">Getting Started</a>:</p><pre><code class="language-julia hljs">using Kinetica
res = load_output(&quot;../my_CRN_out/direct_network_final.bson&quot;)</code></pre><h2 id="Analysing-the-CRN"><a class="docs-heading-anchor" href="#Analysing-the-CRN">Analysing the CRN</a><a id="Analysing-the-CRN-1"></a><a class="docs-heading-anchor-permalink" href="#Analysing-the-CRN" title="Permalink"></a></h2><p>The output CRN is stored across two data structures: a <a href="../../api/kinetica/exploration/#Kinetica.SpeciesData"><code>SpeciesData</code></a> for holding information about the species within the CRN, and a <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a> for holding information about the reactions between those species. These can be accessed through <code>ODESolveOutput.sd</code> and <code>ODESolveOutput.rd</code> respectively. For more information on these objects, see <a href="../../development/crn-representation/#crn_representation_page">CRN Representation</a>.</p><pre><code class="language-julia hljs">sd, rd = res.sd, res.rd</code></pre><p>By default, Kinetica stores information about these species and reactions in a compact form to maintain efficiency when working with large CRNs. For example, reactions are stored as <code>Vector</code>s of integer species IDs. To inspect individual reactions, we can use the <a href="../../api/kinetica/utilities/#Kinetica.print_rxn"><code>print_rxn</code></a> function:</p><pre><code class="language-julia hljs"># Print the first reaction in the CRN.
print_rxn(sd, rd, 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">C --&gt; [CH2] + [H][H]</code></pre><div class="admonition is-info" id="Using-format_rxn-dd71c8e58ce5aad"><header class="admonition-header">Using format_rxn<a class="admonition-anchor" href="#Using-format_rxn-dd71c8e58ce5aad" title="Permalink"></a></header><div class="admonition-body"><p><a href="../../api/kinetica/utilities/#Kinetica.print_rxn"><code>print_rxn</code></a> is just a wrapper to print the string returned by <a href="../../api/kinetica/utilities/#Kinetica.format_rxn"><code>format_rxn</code></a>, which uses the reactants/products and stoichiometries in <code>rd</code> and the species SMILES in <code>sd</code> to generate a human-readable string describing a reaction. If you need to print more information alongside a reaction, consider something like <code>println(&quot;$(format_rxn(sd, rd, rid)): $(extra_data[rid])&quot;)</code>.</p><p>Both <a href="../../api/kinetica/utilities/#Kinetica.print_rxn"><code>print_rxn</code></a> and <a href="../../api/kinetica/utilities/#Kinetica.format_rxn"><code>format_rxn</code></a> accept a keyword argument <code>display_level</code>, which also tags the requested reaction with the exploration level (see <a href="../iterative-exploration/#Iterative-CRN-Exploration">Iterative CRN Exploration</a>) in which it was discovered.</p></div></div><p>The total number of reactions in a CRN is stored in <code>RxData.nr</code>, so printing all the reactions in a CRN is as simple as this loop:</p><pre><code class="language-julia hljs">for i in 1:rd.nr
    print_rxn(sd, rd, i)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">C --&gt; [CH2] + [H][H]
[CH2] + [H][H] --&gt; [CH3] + [H]
[CH2] + [H][H] --&gt; C
[CH3] + [H] --&gt; [CH2] + [H][H]
C --&gt; [CH3] + [H]
[CH3] + [H] --&gt; C
[H][H] --&gt; 2 [H]
2 [H] --&gt; [H][H]
2 [CH2] --&gt; [CH]C
[CH]C + [H][H] --&gt; CC
CC --&gt; [CH2]C + [H]
[CH]C --&gt; 2 [CH2]
CC --&gt; [CH]C + [H][H]
[CH2]C + [H] --&gt; CC
C + [CH3] --&gt; CC + [H]
CC + [H] --&gt; C + [CH3]
[CH2] + [CH3] --&gt; [CH2]C
[CH2]C + [H] --&gt; C=C + [H][H]
C=C --&gt; [CH]=C + [H]
[CH2]C --&gt; [CH2] + [CH3]
C=C + [H][H] --&gt; [CH2]C + [H]
[CH]=C + [H] --&gt; C=C
[CH3] --&gt; [CH2] + [H]
[CH2] + [H] --&gt; [CH3]
C + [CH2] --&gt; [CH2]C + [H]
[CH2]C + [H] --&gt; C + [CH2]
C + [CH2] --&gt; CC
[CH2]C --&gt; [CH]=C + [H][H]
CC --&gt; C + [CH2]
[CH]=C + [H][H] --&gt; [CH2]C</code></pre><p>Other fields of <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a> can also be useful for analysis, such as <code>RxData.mapped_rxns</code>. This field contains the atom-mapped reaction SMILES of all reactions in a CRN, and can be used for constructing multi-species reactant and product geometries with consistent atom indices (vital for any reaction path techniques):</p><pre><code class="language-julia hljs">println(&quot;Atom-mapped reaction SMILES: $(rd.mapped_rxns[1])\n&quot;)

# Split reaction SMILES into individual SMILES for reactants/products.
am_reacs, am_prods = String.(split(rd.mapped_rxns[1], &quot;&gt;&gt;&quot;))

# Generate non-overlapping systems of molecules for reactants and products.
reac_species = [sd.toStr[sid] for sid in rd.id_reacs[1]]
reacsys = system_from_smiles(reac_species; dmin=3.0)
prod_species = [sd.toStr[sid] for sid in rd.id_prods[1]]
prodsys = system_from_smiles(prod_species; dmin=3.0)

# Remap atom indices using atom-mapped SMILES and RDKit substructure matching.
mapped_reacs = atom_map_frame(am_reacs, reacsys)
mapped_prods = atom_map_frame(am_prods, prodsys)

# Add extra info to frames, convert to ExtXYZ and print.
mapped_reacs[&quot;info&quot;][&quot;type&quot;] = &quot;reactant&quot;
mapped_reacs[&quot;info&quot;][&quot;SMILES&quot;] = join(sort(reac_species), &quot;.&quot;)
mapped_prods[&quot;info&quot;][&quot;type&quot;] = &quot;product&quot;
mapped_prods[&quot;info&quot;][&quot;SMILES&quot;] = join(sort(prod_species), &quot;.&quot;)
println(&quot;Reaction XYZ:&quot;)
print(frame_to_xyz(mapped_reacs))
print(frame_to_xyz(mapped_prods))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Atom-mapped reaction SMILES: [C:1]([H:2])([H:3])([H:4])[H:5]&gt;&gt;[C:1]([H:4])[H:5].[H:2][H:3]

Reaction XYZ:
5
SMILES=C type=reactant comment=
C 0.9447905649425166 0.8668928864389129 0.3396155028483221
H 0.5807305649425165 0.492902886438913 -0.619804497151678
H 2.0369905649425166 0.8668928864389129 0.3396155028483221
H 0.5807205649425164 1.884772886438913 0.4954255028483221
H 0.5807205649425164 0.22301288643891304 1.1432055028483221
5
SMILES=[CH2].[H][H] type=product comment=
C -0.6586804795030258 9.91213032297131 -2.5841171432825485
H 20.337829224506123 -3.675939487784442 27.089117847582727
H 21.04582922450612 -3.675939487784442 27.089117847582727
H 0.21084952049697392 9.29748032297131 -2.6029171432825486
H -1.5282804795030258 10.52667032297131 -2.5653271432825484</code></pre><p>As a result of the atom mapping, the hydrogen atoms which dissociate from the reactant ethane are now consistently indexed between reactant and product geometries.</p><h3 id="Species-Reaction-Graphs"><a class="docs-heading-anchor" href="#Species-Reaction-Graphs">Species-Reaction Graphs</a><a id="Species-Reaction-Graphs-1"></a><a class="docs-heading-anchor-permalink" href="#Species-Reaction-Graphs" title="Permalink"></a></h3><p>Kinetica hooks in to the same graph plotting code as <a href="https://github.com/SciML/Catalyst.jl">Catalyst.jl</a>, which uses <a href="https://graphviz.org/">Graphviz</a> to generate figures that show the relationship between species and reactions in a CRN. <a href="../../api/kinetica/analysis/#Catalyst.Graph-Tuple{SpeciesData, RxData}"><code>Graph(::SpeciesData, ::RxData)</code></a> has been extended to allow for easy graph plotting directly from a Kinetica CRN:</p><pre><code class="language-julia hljs">g = Graph(sd, rd)</code></pre><p><img src="../../assets/tutorials/results_analysis/default_graph.svg" alt/></p><p>Graphs generated this way are compatible with Catalyst&#39;s graph methods and can be saved to file using <code>Catalyst.savegraph</code>. </p><div class="admonition is-info" id="Catalyst.jl-Reexports-94f6be5c93f794b"><header class="admonition-header">Catalyst.jl Reexports<a class="admonition-anchor" href="#Catalyst.jl-Reexports-94f6be5c93f794b" title="Permalink"></a></header><div class="admonition-body"><p>While Kinetica doesn&#39;t usually reexport any structs or methods from other packages, we make an exception for <code>Catalyst.Graph</code> and <code>Catalyst.savegraph</code> as we implement methods that can coexist and be interchanged with those in Catalyst. This allows <a href="../../api/kinetica/analysis/#Catalyst.Graph-Tuple{SpeciesData, RxData}"><code>Graph(::SpeciesData, ::RxData)</code></a> to be called as above, but also allows <code>savegraph(::Graph, fname, fmt)</code> to be called without ever calling <code>using Catalyst</code> or needing it explicitly in your Julia project.</p></div></div><p>In addition, Kinetica allows for passing <a href="https://graphviz.org/doc/info/attrs.html">Graphviz attributes</a> directly through to the plotter for extra customisability. These take the form of the <code>graph_attrs</code>, <code>species_attrs</code>, <code>rxn_attrs</code> and <code>edge_attrs</code> keyword arguments to <a href="../../api/kinetica/analysis/#Catalyst.Graph-Tuple{SpeciesData, RxData}"><code>Graph(::SpeciesData, ::RxData)</code></a>, which can be supplied with <code>Dict{Symbol, String}</code>s to modify parameters of the overall graph, the species nodes and the reaction nodes, and the edges respectively:</p><pre><code class="language-julia hljs">g = Graph(sd, rd;
    graph_attrs=Dict(
        :layout =&gt; &quot;sfdp&quot;,
        :overlap =&gt; &quot;prism&quot;,
        :overlap_scaling =&gt; &quot;-8&quot;
    ), species_attrs=Dict(
        :shape =&gt; &quot;hexagon&quot;,
        :color =&gt; &quot;aquamarine1&quot;
    ), rxn_attrs=Dict(
        :shape =&gt; &quot;box&quot;,
        :color =&gt; &quot;coral&quot;
    ), edge_attrs=Dict(
        :color =&gt; &quot;grey59&quot;
    ))</code></pre><p><img src="../../assets/tutorials/results_analysis/modified_graph.svg" alt/></p><p>The exploration level that each species and reaction was found in (see <a href="../iterative-exploration/#Iterative-CRN-Exploration">Iterative CRN Exploration</a>) is additionally added as a Graphviz attribute to each respective node. While this is (probably) not useful within the context of Graphviz&#39;s layout engines, more advanced graphical interfaces such as <a href="https://gephi.org/">Gephi</a> can be used to create level-driven layouts:</p><p><img src="../../assets/crn11.png" alt/></p><div class="admonition is-info" id="On-Graphviz-Installation-153e1b6b143e6ded"><header class="admonition-header">On Graphviz Installation<a class="admonition-anchor" href="#On-Graphviz-Installation-153e1b6b143e6ded" title="Permalink"></a></header><div class="admonition-body"><p>Graphviz is one of Kinetica&#39;s Python dependencies, and as such is always installed at the same time as Kinetica. This is not the case for Catalyst.jl, which either requires a user-installed version of Graphviz, or it uses the <a href="https://github.com/JuliaBinaryWrappers/Graphviz_jll.jl">Graphviz_jll</a> package. As discussed in the section on the <a href="../../#Graphviz">Graphviz</a> dependency, we avoid the JLL due to it missing some key features which Kinetica&#39;s CRNs typically need.</p><p>Kinetica always adds its Python dependencies to the end of the current <code>PATH</code>, so if you have your own installation of Graphviz that you&#39;d like to use, just make sure it&#39;s in your <code>PATH</code> before you start Julia!</p></div></div><h3 id="Species-Analysis"><a class="docs-heading-anchor" href="#Species-Analysis">Species Analysis</a><a id="Species-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Species-Analysis" title="Permalink"></a></h3><p>Kinetica makes use of many functions within both <a href="https://github.com/rdkit/rdkit">RDKit</a> and <a href="https://github.com/openbabel/openbabel">Open Babel</a> to assist with basic property prediction and conversion between geometry and SMILES. A comprehensive list of functions implemented are available in the <a href="../../api/kinetica/openbabel/#Open-Babel">Open Babel</a> and <a href="../../api/kinetica/rdkit/#RDKit">RDKit</a> API pages.</p><p>Kinetica supports cached calculation of properties such as species molecular weights and hard-sphere radii through Open Babel through the <a href="../../api/kinetica/openbabel/#Kinetica.get_species_stats!"><code>get_species_stats!</code></a> function. This places these properties in the <code>SpeciesData.cache</code>, which is useful for storing per-species values during a calculation.</p><p>Kinetica also stores species geometries within <code>SpeciesData.xyz</code>. These are stored as <a href="https://github.com/libAtoms/ExtXYZ.jl">ExtXYZ.jl</a> <code>frame</code>s and can be manipulated as such.</p><h2 id="Analysing-the-Kinetic-Simulation"><a class="docs-heading-anchor" href="#Analysing-the-Kinetic-Simulation">Analysing the Kinetic Simulation</a><a id="Analysing-the-Kinetic-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Analysing-the-Kinetic-Simulation" title="Permalink"></a></h2><p>Most of the information regarding the results of a kinetic simulation are stored in <code>ODESolveOutput.sol</code>, which is a DifferentialEquations <code>ODESolution</code> (in most cases, some extensions may apply depending on the simulation method but this can always be interacted as if it is an <code>ODESolution</code>). As such, the <a href="https://docs.sciml.ai/DiffEqDocs/stable/basics/solution/">DiffEq documentation</a> applies for directly analysing simulation results.</p><p>However, when plotting simulation results, it can often be useful to have information about the experimental conditions that the simulation took place under, as well as some of the other parameters used in the simulation which are not included within the <code>ODESolution</code>. This includes the names of each of the species, which are only referred to be an integer ID within Kinetica&#39;s solution methods. Kinetica therefore includes <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> <a href="https://docs.juliaplots.org/stable/recipes/">plot recipes</a> which act on the <a href="../../api/kinetica/analysis/#Kinetica.ODESolveOutput"><code>ODESolveOutput</code></a> object, as this has access to all of these values alongside the <code>ODESolution</code>. The plots created by these recipes can be modified in the same way as any other Plots.jl figure.</p><h3 id="Concentration-Time-Plots"><a class="docs-heading-anchor" href="#Concentration-Time-Plots">Concentration-Time Plots</a><a id="Concentration-Time-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Concentration-Time-Plots" title="Permalink"></a></h3><p>This is the &#39;default&#39; plot type for <a href="../../api/kinetica/analysis/#Kinetica.ODESolveOutput"><code>ODESolveOutput</code></a>, with the call signature:</p><pre><code class="language-julia hljs">plot(::ODESolveOutput; tunit=&quot;s&quot;, label_above=0.1, ignore_species=nothing, ignore_below=nothing)</code></pre><p>where</p><ul><li><code>tunit</code> is the unit of time to display on the x-axis;</li><li><code>label_above</code> is a concentration above which species should contribute to the plot&#39;s legend and be plotted in a colour (species is grey otherwise);</li><li><code>ignore_species</code> can be a <code>Vector</code> of SMILES strings representing species which should not be plotted (<code>nothing</code> if this is not desired);</li><li><code>ignore_below</code> can be a concentration threshold where species with a maximum concentration below are not plotted (<code>nothing</code> if this is not desired).</li></ul><p>For example, plotting the same results as in <a href="../../getting-started/#Getting-Started">Getting Started</a>, but excluding the radical species from the plot is simple:</p><pre><code class="language-julia hljs">using Plots

is_radical(smi) = (&#39;[&#39; in smi) &amp;&amp; !(smi == &quot;[H][H]&quot;)
radical_species = [spec for spec in [sd.toStr[i] for i in 1:sd.n] if is_radical(spec)]

plot(res; label_above=0.01, ignore_species=radical_species, linewidth=5)</code></pre><p><img src="../../assets/tutorials/results_analysis/kinetics_plot.svg" alt/></p><div class="admonition is-info" id="Using-Plots.jl-Arguments-fa73743831a7e696"><header class="admonition-header">Using Plots.jl Arguments<a class="admonition-anchor" href="#Using-Plots.jl-Arguments-fa73743831a7e696" title="Permalink"></a></header><div class="admonition-body"><p>Notice how we&#39;ve used the <code>linewidth</code> keyword argument here, but this isn&#39;t defined explicitly in this plot recipe. This is because Plots.jl allows for modifying figures, both within the original <code>plot</code> call and in subsequent <code>plot!</code> calls - we could&#39;ve similarly done <code>plot!(linewidth=5)</code> after our original <code>plot</code> call to achieve the same goal.</p></div></div><h3 id="Conditions-Plots"><a class="docs-heading-anchor" href="#Conditions-Plots">Conditions Plots</a><a id="Conditions-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Conditions-Plots" title="Permalink"></a></h3><p>Kinetica defines a separate plot recipe for variable condition profiles, <code>conditionsplot</code>:</p><pre><code class="language-julia hljs">conditionsplot(::Union{::ODESolveOutput, ConditionSet}, ::Symbol; tunit=&quot;s&quot;)</code></pre><p>This recipe can take either an <a href="../../api/kinetica/analysis/#Kinetica.ODESolveOutput"><code>ODESolveOutput</code></a> or a <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a>, but it has a second mandatory argument - a <code>Symbol</code> representing the condition profile to plot. For example, if a variable temperature profile is required (and it exists in the <a href="../../api/kinetica/conditions/#ConditionSet"><code>ConditionSet</code></a> being plotted), then this is usually available under <code>:T</code>. Again, <code>tunit</code> is the unit of time to display on the x-axis.</p><pre><code class="language-julia hljs"># Again, this is compatible with Plots.jl keyword arguments.
conditionsplot(res, :T; linecolor=:red)</code></pre><p><img src="../../assets/tutorials/results_analysis/temperature_plot.svg" alt/></p><h3 id="Final-Concentration-Plots"><a class="docs-heading-anchor" href="#Final-Concentration-Plots">Final Concentration Plots</a><a id="Final-Concentration-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#Final-Concentration-Plots" title="Permalink"></a></h3><p>It can often be useful to examine the final species concentrations at the end of a kinetic simulation, as these often correspond to experimental observables. Kinetica implements a specialised bar chart recipe for this, <code>finalconcplot</code>:</p><pre><code class="language-julia hljs">finalconcplot(::ODESolveOutput; 
              quantity=:conc, n_top=10, highlight_radicals=false, 
              ignore_species=nothing, xscale=:identity)</code></pre><p>where</p><ul><li><code>quantity</code> is a <code>Symbol</code>, either <code>:conc</code> or <code>:percent</code>. The former plots species concentrations, while the latter plots percentage concentrations with respect to the overall reaction mixture;</li><li><code>n_top</code> controls the number of species to include in the plot. These are sorted in decreasing order, with species outside <code>n_top</code> going into their own &#39;Others&#39; bar at the end. For example, with <code>n_top=10</code>, the 10 species with the highest final concentrations will be plotted, followed by a bar for the combined final concentration of all other species;</li><li><code>highlight_radicals</code> colours radical species in red when <code>true</code>, as these are often not desired at the end of simulations;</li><li><code>ignore_species</code> accepts a <code>Vector</code> of SMILES strings for species to exclude from the plot. This can be useful when inert species are present with concentrations that are unimportant to the final state of the CRN (<code>nothing</code> if this is not desired);</li><li><code>xscale</code> mimics Plots.jl&#39;s <code>xscale</code> option for setting the scaling of the x-axis. In this case, only <code>:identity</code> (default) and <code>:log10</code> are supported, as additional calculations are required to obtain the correct x-axis limits for correct bar chart rendering.</li></ul><pre><code class="language-julia hljs">finalconcplot(res; quantity=:percent, n_top=5, highlight_radicals=true)</code></pre><p><img src="../../assets/tutorials/results_analysis/concs_plot.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../iterative-exploration/">« Iterative CRN Exploration</a><a class="docs-footer-nextpage" href="../filtering-crns/">Filtering CRNs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 30 May 2025 02:03">Friday 30 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
