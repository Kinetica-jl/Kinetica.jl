<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Iterative CRN Exploration · Kinetica.jl</title><meta name="title" content="Iterative CRN Exploration · Kinetica.jl"/><meta property="og:title" content="Iterative CRN Exploration · Kinetica.jl"/><meta property="twitter:title" content="Iterative CRN Exploration · Kinetica.jl"/><meta name="description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="og:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><meta property="twitter:description" content="Documentation for the Kinetica.jl package and its modular kinetic calculators."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="Kinetica.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Kinetica.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../arbitrary-conditions/">Arbitrary Simulation Conditions</a></li><li><a class="tocitem" href="../ode-solution/">ODE Solution</a></li><li><a class="tocitem" href="../kinetic-calculators/">Kinetic Calculators</a></li><li class="is-active"><a class="tocitem" href>Iterative CRN Exploration</a><ul class="internal"><li><a class="tocitem" href="#Example"><span>Example</span></a></li><li><a class="tocitem" href="#Setting-seed_conc"><span>Setting <code>seed_conc</code></span></a></li></ul></li><li><a class="tocitem" href="../results-analysis/">Results Analysis</a></li><li><a class="tocitem" href="../filtering-crns/">Filtering CRNs</a></li><li><a class="tocitem" href="../saving-loading/">Saving &amp; Loading</a></li><li><a class="tocitem" href="../logging/">Logging</a></li></ul></li><li><span class="tocitem">Developing with Kinetica</span><ul><li><a class="tocitem" href="../../development/crn-representation/">CRN Representation</a></li><li><a class="tocitem" href="../../development/condition-profiles/">Condition Profiles</a></li><li><a class="tocitem" href="../../development/calculator-interface/">Calculator Interface</a></li><li><a class="tocitem" href="../../development/ase-calculator-builders/">ASE Calculator Builders</a></li><li><a class="tocitem" href="../../development/implementation-details/">Implementation Details</a></li></ul></li><li><span class="tocitem">API</span><ul><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">Kinetica.jl</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/exploration/">Exploration</a></li><li><a class="tocitem" href="../../api/kinetica/solving/">Solving</a></li><li><a class="tocitem" href="../../api/kinetica/conditions/">Conditions</a></li><li><a class="tocitem" href="../../api/kinetica/analysis/">Analysis</a></li><li><a class="tocitem" href="../../api/kinetica/openbabel/">Open Babel</a></li><li><a class="tocitem" href="../../api/kinetica/rdkit/">RDKit</a></li><li><a class="tocitem" href="../../api/kinetica/utilities/">Utilities</a></li><li><input class="collapse-toggle" id="menuitem-5-1-8" type="checkbox"/><label class="tocitem" for="menuitem-5-1-8"><span class="docs-label">ASE Interface</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/kinetica/ase_calculator/calculator/">Kinetic Calculator</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/optimisation/">Optimisation</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/builders/">Builders</a></li><li><a class="tocitem" href="../../api/kinetica/ase_calculator/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../api/kinetica/autode/">autodE Interface</a></li></ul></li><li><a class="tocitem" href="../../api/kineticakpm/">KineticaKPM.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Iterative CRN Exploration</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Iterative CRN Exploration</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Kinetica-jl/Kinetica.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Iterative-CRN-Exploration"><a class="docs-heading-anchor" href="#Iterative-CRN-Exploration">Iterative CRN Exploration</a><a id="Iterative-CRN-Exploration-1"></a><a class="docs-heading-anchor-permalink" href="#Iterative-CRN-Exploration" title="Permalink"></a></h1><p>The iterative CRN exploration method (<a href="../../api/kinetica/exploration/#Kinetica.IterativeExplore"><code>IterativeExplore</code></a>) allows for CRNs to be efficiently explored by only attempting to find reactions involving kinetically viable species. In the vast majority of cases, this produces CRNs with more thoroughly sampled reactions per species than the direct exploration method (<a href="../../api/kinetica/exploration/#Kinetica.DirectExplore"><code>DirectExplore</code></a>, demonstrated in <a href="../../getting-started/#Getting-Started">Getting Started</a>).</p><p><img src="../../assets/Direct_vs_iterative_schematics.svg" alt/></p><p>The figure above shows the main methodological differences between the direct and iterative exploration methods. In the direct method (a), as many reactions as possible are explored outwards from a starting system of species. This is done by successive iterations of stochastic mechanism generation with CDE&#39;s single-ended graph-driven sampling (SE-GDS) method. Each random mechanism is of length <span>$n_r$</span>, controlled within Kinetica by the <code>radius</code> parameter in a <a href="../../api/kinetica/exploration/#Kinetica.CDE"><code>CDE</code></a> parameter block. </p><p>CRNs are built by adding all new reactions from each mechanism to the current <a href="../../api/kinetica/exploration/#Kinetica.SpeciesData"><code>SpeciesData</code></a> and <a href="../../api/kinetica/exploration/#Kinetica.RxData"><code>RxData</code></a> (see <a href="../../development/crn-representation/#crn_representation_page">CRN Representation</a> for details). Mechanism generation proceeds until a user-defined number of CDE iterations have passed without any new reactions being added to the CRN (controlled by the <code>rxn_convergence_threshold</code> parameter of <a href="../../api/kinetica/exploration/#Kinetica.DirectExplore"><code>DirectExplore</code></a>).</p><p>The direct method has a number of flaws when applied to large CRNs - it is capable of simultaneously under-exploring reactions between species many reactive steps away from the starting system, and it over-explores species and reactions that may never form/occur due to the kinetics of the CRN as a whole. This is the rationale behind the iterative exploration method.</p><p>In the iterative method (b), exploration proceeds in levels. Each level consists of the following steps:</p><ol><li><p>A system of species is created. CDE requires species to be input within a single XYZ file, so care must be taken to place species in Cartesian space such that they are separated (not considered to be bonded to one another). </p><ul><li>This is performed by optimisation of a spring-particle system that moves species&#39; centres of mass (see <a href="../../api/kinetica/exploration/#Molecule-System">Molecule System</a>).</li></ul></li><li><p>Reactions of species within this system are explored. This is usually set such that only adjacent reactions - those that are a single reaction away from reactants within the given species system - are explored, as this avoids the most unnecessary exploration. </p><ul><li>This is first done by finding all same-species reactions, both unimolecular and bimolecular, then finding all different-species reactions. This occurs in dedicated subspaces, which are then collated to form the overall level.</li><li>Each subspace is considered to be converged in the same way as a direct method CRN - once a user-defined number of CDE iterations have passed without any new reactions being discovered (controlled by the <code>rxn_convergence_threshold</code> parameter of <a href="../../api/kinetica/exploration/#Kinetica.IterativeExplore"><code>IterativeExplore</code></a>).</li></ul></li><li><p>A kinetic simulation is run with the full CRN explored so far. This is done to identify species which exist at a high concentration at some point during the time period of interest, as these species are the most likely to react since they are most prevalent in the reaction mixture.</p><ul><li>These high concentration species are referred to as <em>seed</em> species within Kinetica, as they are used to grow the next level of exploration.</li><li>Species are selected as seeds if they have a maximum concentration above the <code>seed_conc</code> parameter of <a href="../../api/kinetica/exploration/#Kinetica.IterativeExplore"><code>IterativeExplore</code></a>.</li></ul></li><li><p>The seed species are collated and the next level begins at step 1.</p></li></ol><p>The iterative exploration method stops generating new levels of reactions once <code>seed_convergence_threshold</code> levels of exploration have passed without the seed system changing. This indicates that the remaining seeds are the high concentration species that should exist within the full CRN.</p><p>By only exploring down reactive pathways that are kinetically viable, the iterative exploration method avoids the combinatorial explosion of possible reactions that the direct method faces. This comes with the benefit of avoiding exploration of reactions that cannot occur because their reactants are never formed, speeding up kinetic simulations dramatically.</p><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>From a user&#39;s perspective, running a CRN exploration with the iterative method is almost identical to running one with the direct method. The simulation conditions, parameters and calculator are all defined in the same way, but an <a href="../../api/kinetica/exploration/#Kinetica.IterativeExplore"><code>IterativeExplore</code></a> parameter block is used instead of a <a href="../../api/kinetica/exploration/#Kinetica.DirectExplore"><code>DirectExplore</code></a> block:</p><pre><code class="language-julia hljs">crn_dir = &quot;./my_iterative_CRN&quot;

exploremethod = IterativeExplore(
    rdir_head = crn_dir,
    reac_smiles = [&quot;C&quot;],
    rxn_convergence_threshold = 5,
    seed_convergence_threshold = 3,
    seed_conc = 0.05,
    independent_blacklist = [&quot;[H]&quot;],
    cde = CDE(
        template_dir = &quot;./cde_template&quot;,
        radius = 1
    )
)</code></pre><p>Most of the new parameters here are defined above, with exception of the <code>independent_blacklist</code> parameter. This defines a list of SMILES species names which should not be subjected to same-species reactions within their own subspace. The hydrogen radical is shown here as an example, as it cannot break down any more and the only reactions which consume it are the opposites of those that create it.</p><h2 id="Setting-seed_conc"><a class="docs-heading-anchor" href="#Setting-seed_conc">Setting <code>seed_conc</code></a><a id="Setting-seed_conc-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-seed_conc" title="Permalink"></a></h2><p>The value of the <code>seed_conc</code> parameter is crucial in iterative explorations, effectively determining the accuracy of the resulting CRN. Set too high, very few species will ever have maximum concentrations above it and CRN levels will not contain many reactions, leading to a CRN that converges very quickly but is not sampled enough to be accurate. If <code>seed_conc</code> is set too low however, too many species will become seeds and individual levels will struggle to converge due to the breadth of reactions that must be sampled.</p><p>Finding the &#39;correct&#39; value of <code>seed_conc</code> is therefore not a simple task - it is highly dependent on the species being reacted and the conditions and kinetic calculator that the simulations which guide the CRN exploration are using. We therefore recommend that multiple iterative explorations are run with decreasing values of <code>seed_conc</code> until an acceptable CRN accuracy has been found (i.e. the CRN is as complete as it needs to be for your use case). It can help if you have some experimental results for a related initial system under similar conditions to compare against.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../kinetic-calculators/">« Kinetic Calculators</a><a class="docs-footer-nextpage" href="../results-analysis/">Results Analysis »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Monday 9 June 2025 16:38">Monday 9 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
